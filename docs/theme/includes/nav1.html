<ul class="nav-list">
  {%- assign titled_pages = include.pages
        | where_exp:"item", "item.title != nil" -%}

 
  {%- assign nav_ordered_pages = titled_pages
        | where_exp:"item", "item.nav_order != nil"  -%}

  {%- assign nav_ordered_groups = nav_ordered_pages
        | group_by_exp:"item", "item.nav_order | jsonify | slice: 0" -%}
  {%- assign number_ordered_pages = "" | split:"X" -%}
  
  {%- assign sorted_number_ordered_pages = number_ordered_pages | sort:"nav_order" -%}
  
  {%- assign pages_list = sorted_number_ordered_pages -%}

  {%- for node in pages_list -%}
    {%- if node.parent == nil -%}
      {%- unless node.nav_exclude -%}
      {%- assign temp_page_version = page.url | split: '/' -%}
      {%- assign temp_node_url = node.url | split: '/' -%}
      {%- if temp_page_version[1] == temp_node_url[1] -%}
      <li class="nav-list-item{% if page.url == node.filepath or page.parent == node.title or page.grand_parent == node.title %} active{% endif %}">
        <a href="{{ node.dir + node.filepath | absolute_url }}" class="nav-list-link{% if page.url == node.filepath %} active{% endif %}">{{ node }}</a>
      </li>
      {%- endif -%}
      {%- endunless -%}
    {%- endif -%}
  {%- endfor -%}
</ul>
